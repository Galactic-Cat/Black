<!DOCTYPE html>
<div class="mdc-elevation--z3 box">
  <h1 class="mdc-typography--title">General Settings</h1>
  <h1 class="mdc-typography--subheading1">These settings take effect after restarting Black.</h1>
  <div class="mdc-form-field">
    <div class="mdc-checkbox">
      <input id="disableHardwareAcceleration" type="checkbox" class="mdc-checkbox__native-control">
      <div class="mdc-checkbox__background">
        <svg class="mdc-checkbox__checkmark" viewbox="0 0 24 24">
          <path class="mdc-checkbox__checkmark__path" fill="none" stroke="white" d="M1.73,12.91 8.1,19.28 22.79,4.59" />
        </svg>
        <div class="mdc-checkbox__mixedmark"></div>
      </div>
    </div>
    <label for="disableHardwareAcceleration">Disable Hardware Acceleration</label>
  </div>
</div>
<div class="mdc-elevation--z3 box">
  <h1 class="mdc-typography--title">Tease Dashboard</h1>
  <div>
    <p class="mdc-typography--body1" style="margin-bottom: 0;">Preferred ratio of cards to pictures.</p>
    <div id="ratioslider" class="mdc-slider mdc-slider--discrete" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="100" aria-valuenow="10" aria-label="Select Value">
      <div class="mdc-slider__track-container" style="background-color: var(--mdc-theme-primary);">
        <div class="mdc-slider__track" style="background-color: var(--mdc-theme-secondary);"></div>
      </div>
      <div class="mdc-slider__thumb-container">
        <div class="mdc-slider__pin">
          <span class="mdc-slider__pin-value-marker"></span>
        </div>
        <svg class="mdc-slider__thumb" width="21" height="21" style="stroke: var(--mdc-theme-secondary);">
          <circle cx="10.5" cy="10.5" r="7.875"></circle>
        </svg>
        <div class="mdc-slider__focus-ring"></div>
      </div>
    </div>
    <p class="mdc-typography--caption" style="margin: -10px 0 0 0; width: 100%; text-align: center;">
      <span class="mdc-theme--secondary" style="float: left;">cards</span>
      <span><span id="ratioperc" class="mdc-theme--secondary">10%</span> / <span id="notratioperc" class="mdc-theme--primary">90%</span></span>
      <span class="mdc-theme--primary" style="float: right;">pictures</span>
    </p>
    <p class="mdc-typography--caption" style="margin-top: 0;">Default is <span class="mdc-theme--secondary">10%</span> / <span class="mdc-theme--primary">90%</span></p>
  </div>
</div>
<div class="mdc-elevation--z3 box">
  <h1 class="mdc-typography--title">Tease End</h1>
  <div class="mdc-form-field">
    <label for="autoReport" class="mdc-switch-label" style="padding-left: 0;">Automaticaly save Tease reports</label>
    &nbsp;&nbsp;
    <div class="mdc-switch">
      <input type="checkbox" id="autoReport" class="mdc-switch__native-control" />
      <div class="mdc-switch__background">
        <div class="mdc-switch__knob"></div>
      </div>
    </div>
  </div>
  <div id="autoReportPathDiv" style="display: none;">
    <span class="mdc-typography--body1">Select a location to save reports:</span><br>
    <button id="autoReportPathBtn" class="mdc-button mdc-button--raised mdc-button--primary mdc-ripple" data-mdc-auto-init="MDCRipple">Browse</button>
    <label id="autoReportPathLabel" class="box" style="margin-left: 5px; background-color: rgba(0, 0, 0, 0.2); border-radius: 5px; display: none;"></label>
  </div>
</div>
<div class="mdc-elevation--z3 box">
  <h1 class="mdc-typography--title">Sublevel tags</h1>
  <p class="mdc-typography--body1">
    How should we refer to your sublevel when it's low/neutral/high?<br>
    Example: <i>You've been a <span id="subtagsExampleTagGood" class="mdc-theme--secondary">good</span> / <span id="subtagsExampleTagNeutral" class="mdc-theme--secondary">boring</span> / <span id="subtagsExampleTagBad" class="mdc-theme--secondary">bad</span>&nbsp;<span id="subtagsExampleGenderNick">boy</span>.</i>
  </p>
  <div class="mdc-form-field" style="width: 100%;">
    <div class="mdc-textfield" data-mdc-auto-init="MDCTextfield">
      <input type="text" id="subtagsGood" class="mdc-textfield__input" value="good" />
      <label for="subtagsGood" class="mdc-textfield__label">Obedient (high sublevel)</label>
    </div>
    &nbsp;
    <div class="mdc-textfield" data-mdc-auto-init="MDCTextfield">
      <input type="text" id="subtagsNeutral" class="mdc-textfield__input" value="boring" />
      <label for="subtagsNeutral" class="mdc-textfield__label">Neutral</label>
    </div>
    &nbsp;
    <div class="mdc-textfield" data-mdc-auto-init="MDCTextfield">
      <input type="text" id="subtagsBad" class="mdc-textfield__input" value="bad" />
      <label for="subtagsBad" class="mdc-textfield__label">Defiant (low sublevel)</label>
    </div>
  </div>
</div>
<div class="mdc-elevation--z3 box">
  <h1 class="mdc-typography--title">Danger Zone</h1>
  <div class="mdc-form-field">
    <p class="mdc-typography--body1">To delete all values (this cannot be undone), open the developer console with <span class="mdc-theme--secondary">Ctrl + Shift + C</span>.<br>
    Then, navigate to the <span class="mdc-theme--secondary">Console</span> tab, and type <span class="mdc-theme--secondary">resetAll()</span> and press enter.
    </p>
  </div>
</div>
<div style="margin: 10px 0;">
  <p class="mdc-typography--body1" style="text-align: center;">Settings are saved automatically.</p>
</div>

<script type="text/javascript">
  /* global $, mdc, config, dialog */

  if (typeof ratioslider !== 'undefined') {
    ratioslider = ratioslider.destroy()
  }
  var ratioslider = new mdc.slider.MDCSlider($('#ratioslider')[0])
  ratioslider.value = config.get('settings.cardratio') || 10
  $('#ratioperc').text((config.get('settings.cardratio') || 10) + '%')
  $('#notratioperc').text((100 - (config.get('settings.cardratio') || 10)) + '%')

  ratioslider.listen('MDCSlider:change', _ => {
    $('#ratioperc').text(`${ratioslider.value}%`)
    $('#notratioperc').text(`${100 - ratioslider.value}%`)
    config.set('settings.cardratio', ratioslider.value)
  })

  $('#subtagsGood, #subtagsNeutral, #subtagsBad').change((data) => {
    let val = $(data.target).val()
    let gnb = $(data.target).attr('id').slice(7)
    $('#subtagsExampleTag' + gnb).text(val)
    config.set('settings.subtags.' + gnb.toLowerCase(), val)
  })

  if (config.get('settings.subtags') !== undefined) {
    $('#subtagsGood').val(config.get('settings.subtags.good') || 'good')
    $('#subtagsExampleTagGood').text(config.get('settings.subtags.good') || 'good')
    $('#subtagsNeutral').val(config.get('settings.subtags.neutral') || 'boring')
    $('#subtagsExampleTagNeutral').text(config.get('settings.subtags.neutral') || 'boring')
    $('#subtagsBad').val(config.get('settings.subtags.bad') || 'bad')
    $('#subtagsExampleTagBad').text(config.get('settings.subtags.bad') || 'bad')
  }

  if (config.get('settings.disableHardwareAcceleration') === true) {
    $('#disableHardwareAcceleration').prop('checked', true)
  }

  $('#disableHardwareAcceleration').on('click', _ => {
    config.set('settings.disableHardwareAcceleration', $('#disableHardwareAcceleration').is(':checked'))
  })

  if (config.get('profile.gender.nick') !== undefined) $('#subtagsExampleGenderNick').text(config.get('profile.gender.nick'))

  $('#autoReport').change(_ => {
    let check = $('#autoReport').is(':checked')
    if (check) {
      config.set('settings.autoReport', true)
      $('#autoReportPathDiv').slideDown(200)
    } else {
      config.set('settings.autoReport', false)
      $('#autoReportPathDiv').slideUp(200)
    }
  })

  if (config.get('settings.autoReport')) $('#autoReport').trigger('click')

  if (config.get('settings.autoReportPath') !== undefined) {
    $('#autoReportPathLabel').text(config.get('settings.autoReportPath'))
    $('#autoReportPathLabel').fadeIn(100)
  }

  $('#autoReportPathBtn').click(_ => {
    dialog.showOpenDialog({
      title: 'Select location to save reports',
      properties: ['openDirectory']
    }, (path) => {
      if (path !== '' && path !== undefined) {
        config.set('settings.autoReportPath', path)
        $('#autoReportPathLabel').text(path)
        $('#autoReportPathLabel').fadeIn(200)
      } else {
        $('#autoReportPathLabel').fadeOut(200)
      }
    })
  })

  function resetAll () {
    config.clear()
    document.location.href = document.location.href
  }

  $('#swapper').ready(_ => {
    ratioslider.layout()
    mdc.autoInit()
    if (resetAll) {}
  })
</script>
