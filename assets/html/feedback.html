<!DOCTYPE html>
<div class="mdc-elevation--z3 box">
  <h1 class="mdc-typography--title">Feedback</h1>
  <h1 class="mdc-typography--subheading1">Please submit your feedback, in english or dutch, in the box below:</h1>
  <hr>
  <div class="mdc-textfield mdc-textfield--multiline" data-mdc-auto-init="MDCTextfield">
    <textarea id="multi-line" class="mdc-textfield__input" cols="40" rows="10"></textarea>
    <label for="multi-line" class="mdc-textfield__label">Hello</label>
  </div>
  <br>
  <div class="mdc-select" id="feedback-type" role="listbox" tabindex="0">
    <span class="mdc-select__selected-text">Feedback type</span>
    <div class="mdc-simple-menu mdc-select__menu">
      <ul class="mdc-list mdc-simple-menu__items">
        <li class="mdc-list-item" role="option" id="type-bugreport" tabindex="0">Bugreport</li>
        <li class="mdc-list-item" role="option" id="type-request" tabindex="0">Feature request</li>
        <li class="mdc-list-item" role="option" id="type-other" tabindex="0">Other</li>
      </ul>
    </div>
  </div><br>
  <div class="mdc-textfield" data-mdc-auto-init="MDCTextfield">
    <input type="text" id="userid" class="mdc-textfield__input" />
    <label for="userid" class="mdc-textfield__label">Forum name (optional)</label>
  </div>
  <button type="button" id="feedback-submit" class="mdc-button mdc-button--raised mdc-button--primary mdc-ripple" data-mdc-auto-init="MDCRipple">Submit Feedback</button>
</div>

<aside id="feedbackDialog" class="mdc-dialog" role="alertdialog" aria-labelledby="feedbackDialog-label" aria-describedby="feedbackDialog-description">
  <div class="mdc-dialog__surface">
    <header class="mdc-dialog__header">
      <h2 id="feedbackDialog-label" class="mdc-dialog__header__title">Your feedback seems incomplete.</h2>
    </header>
    <section id="feedbackDialog-description" class="mdc-dialog__body">
      Please make sure you've selected a feedback type, and the feedback isn't left empty.
    </section>
    <footer class="mdc-dialog__footer">
      <button type="button" class="mdc-button mdc-dialog__footer__button mdc-dialog__footer__button--cancel">Ok</button>
    </footer>
  </div>
</aside>

<script type="text/javascript">
  /* global $, mdc */

  var feedbackType = new mdc.select.MDCSelect($('#feedback-type')[0])
  var feedbackDialog = new mdc.dialog.MDCDialog($('#feedbackDialog')[0])
  var feedback = {}

  $('#swapper').ready(_ => {
    mdc.autoInit()

    $('#feedback').on('change', _ => {
      if ($('#feedback').val() === '' || $('#feedback').val() == null) {
        delete feedback.text
      } else {
        feedback.text = $('#feedback').val()
      }
    })

    $('#userid').on('change', _ => {
      if ($('#userid').val() === '' || $('#userid').val() == null) {
        delete feedback.user
      } else {
        feedback.user = $('#userid').val().toLowerCase()
      }
    })

    feedbackType.listen('MDCSelect:change', _ => {
      let val = feedbackType.value.split('-')[1]
      if (typeof val !== 'string') {
        delete feedback.type
      } else {
        feedback.type = val
      }
    })

    $('#feedback-submit').on('click', _ => {
      if (feedback.type == null || feedback.text == null) {
        feedbackDialog.show()
      } else {
        // Firebase
      }
    })

    feedbackDialog.listen('MDCDialog:cancel', _ => {
      feedbackDialog.close()
    })
  })
</script>
